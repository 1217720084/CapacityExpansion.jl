<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimization Problem Formulation · CapacityExpansion.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="CapacityExpansion.jl logo"/></a><h1>CapacityExpansion.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Introduction</a></li><li><a class="toctext" href="../workflow/">Workflow</a></li><li><span class="toctext">Data</span><ul><li><a class="toctext" href="../preparing_clust_data/">Preparing ClustData</a></li><li><a class="toctext" href="../preparing_opt_cep_data/">Preparing OptDataCEP</a></li><li><a class="toctext" href="../csv_structure/">Provided Data &amp; Personal Data Setup</a></li><li><a class="toctext" href="../README_GER_18/">GER-18</a></li><li><a class="toctext" href="../README_GER_1/">GER-1</a></li><li><a class="toctext" href="../README_CA_14/">CA-14</a></li><li><a class="toctext" href="../README_CA_1/">CA-1</a></li><li><a class="toctext" href="../README_TX_1/">TX-1</a></li></ul></li><li><span class="toctext">Optimization</span><ul><li class="current"><a class="toctext" href>Optimization Problem Formulation</a><ul class="internal"><li><a class="toctext" href="#General-1">General</a></li><li><a class="toctext" href="#Variables-and-Sets-1">Variables and Sets</a></li><li><a class="toctext" href="#Running-the-Capacity-Expansion-Problem-1">Running the Capacity Expansion Problem</a></li><li><a class="toctext" href="#Solver-1">Solver</a></li><li><a class="toctext" href="#Opt-Result-A-closer-look-1">Opt Result - A closer look</a></li></ul></li><li><a class="toctext" href="../opt_cep_examples/">Examples</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Optimization</li><li><a href>Optimization Problem Formulation</a></li></ul><a class="edit-page" href="https://github.com/YoungFaithful/CapacityExpansion.jl/blob/master/docs/src/opt_cep.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Optimization Problem Formulation</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Optimization-Problem-Formulation-1" href="#Optimization-Problem-Formulation-1">Optimization Problem Formulation</a></h1><h2><a class="nav-anchor" id="General-1" href="#General-1">General</a></h2><p>The capacity expansion problem (CEP) is designed as a linear optimization model. It is implemented in the algebraic modeling language <a href="http://www.juliaopt.org/JuMP.jl/latest/">JUMP</a>. The implementation within JuMP allows to optimize multiple models in parallel and handle the steps from data input to result analysis and diagram export in one open source programming language. The coding of the model enables scalability based on the provided data input, single command based configuration of the setup model, result and configuration collection for further analysis and the opportunity to run design and operation in different optimizations.</p><p><img src="../assets/opt_cep.svg" alt="Plot"/></p><p>The basic idea for the energy system is to have a spacial resolution of the energy system in discrete nodes. Each node has demand, non-dispatchable generation, dispatachable generation and storage capacities of varying technologies connected to itself. The different energy system nodes are interconnected with each other by transmission lines. The model is designed to minimize social costs by minimizing the following objective function:</p><div>\[min \sum_{account,tech}COST_{account,&#39;EUR/USD&#39;,tech} + \sum LL \cdot  cost_{LL} + LE \cdot  cos_{LE}\]</div><h2><a class="nav-anchor" id="Variables-and-Sets-1" href="#Variables-and-Sets-1">Variables and Sets</a></h2><p>The models scalability is relying on the usage of sets. The elements of the sets are extracted from the input data and scale the different variables. An overview of the sets is provided in the table. Depending on the models configuration the necessary sets are initialized.</p><table><tr><th style="text-align: right">name</th><th style="text-align: right">description</th></tr><tr><td style="text-align: right">lines</td><td style="text-align: right">transmission lines connecting the nodes</td></tr><tr><td style="text-align: right">nodes</td><td style="text-align: right">spacial energy system nodes</td></tr><tr><td style="text-align: right">tech</td><td style="text-align: right">fossil and renewable generation as well as storage technologies</td></tr><tr><td style="text-align: right">impact</td><td style="text-align: right">impact categories like EUR or USD, CO 2 − eq., ...</td></tr><tr><td style="text-align: right">account</td><td style="text-align: right">fixed costs for installation and yearly expenses, variable costs</td></tr><tr><td style="text-align: right">infrastruct</td><td style="text-align: right">infrastructure status being either new or existing</td></tr><tr><td style="text-align: right">sector</td><td style="text-align: right">energy sector like electricity</td></tr><tr><td style="text-align: right">time K</td><td style="text-align: right">numeration of the representative periods</td></tr><tr><td style="text-align: right">time T</td><td style="text-align: right">numeration of the time intervals within a period</td></tr><tr><td style="text-align: right">time T e</td><td style="text-align: right">numeration of the time steps within a period</td></tr><tr><td style="text-align: right">time I</td><td style="text-align: right">numeration of the time invervals of the full input data periods</td></tr><tr><td style="text-align: right">time I e</td><td style="text-align: right">numeration of the time steps of the full input data periods</td></tr><tr><td style="text-align: right">dir transmission</td><td style="text-align: right">direction of the flow uniform with or opposite to the lines direction</td></tr></table><p>An overview of the variables used in the CEP is provided in the table:</p><table><tr><th style="text-align: right">name</th><th style="text-align: right">dimensions</th><th style="text-align: right">unit</th><th style="text-align: right">description</th></tr><tr><td style="text-align: right">COST</td><td style="text-align: right">[account,impact,tech]</td><td style="text-align: right">EUR/USD, LCA-categories</td><td style="text-align: right">Costs</td></tr><tr><td style="text-align: right">CAP</td><td style="text-align: right">[tech,infrastruct,node]</td><td style="text-align: right">MW</td><td style="text-align: right">Capacity</td></tr><tr><td style="text-align: right">GEN</td><td style="text-align: right">[sector,tech,t,k,node]</td><td style="text-align: right">MW</td><td style="text-align: right">Generation</td></tr><tr><td style="text-align: right">SLACK</td><td style="text-align: right">[sector,t,k,node]</td><td style="text-align: right">MW</td><td style="text-align: right">Power gap, not provided by installed CAP</td></tr><tr><td style="text-align: right">LL</td><td style="text-align: right">[sector]</td><td style="text-align: right">MWh</td><td style="text-align: right">LoastLoad Generation gap, not provided by installed CAP</td></tr><tr><td style="text-align: right">LE</td><td style="text-align: right">[impact]</td><td style="text-align: right">LCA-categories</td><td style="text-align: right">LoastEmission Amount of emissions that installed CAP crosses the Emission constraint</td></tr><tr><td style="text-align: right">INTRASTOR</td><td style="text-align: right">[sector, tech,t,k,node]</td><td style="text-align: right">MWh</td><td style="text-align: right">Storage level within a period</td></tr><tr><td style="text-align: right">INTERSTOR</td><td style="text-align: right">[sector,tech,i,node]</td><td style="text-align: right">MWh</td><td style="text-align: right">Storage level between periods of the full time series</td></tr><tr><td style="text-align: right">FLOW</td><td style="text-align: right">[sector,dir,tech,t,k,line]</td><td style="text-align: right">MW</td><td style="text-align: right">Flow over transmission line</td></tr><tr><td style="text-align: right">TRANS</td><td style="text-align: right">[tech,infrastruct,lines]</td><td style="text-align: right">MW</td><td style="text-align: right">maximum capacity of transmission lines</td></tr></table><h2><a class="nav-anchor" id="Running-the-Capacity-Expansion-Problem-1" href="#Running-the-Capacity-Expansion-Problem-1">Running the Capacity Expansion Problem</a></h2><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The CEP model can be run with many configurations. The configurations themselves don&#39;t mess with each other though the provided input data must fulfill the ability to have e.g. lines in order for transmission to work.</p></div></div><p>An overview is provided in the following table:</p><table><tr><th style="text-align: right">description</th><th style="text-align: right">unit</th><th style="text-align: right">configuration</th><th style="text-align: right">values</th><th style="text-align: right">type</th><th style="text-align: right">default value</th></tr><tr><td style="text-align: right">enforce a CO2-limit</td><td style="text-align: right">kg-CO2e/MWh</td><td style="text-align: right"><code>co2_limit</code></td><td style="text-align: right">&gt;0</td><td style="text-align: right">::Number</td><td style="text-align: right">Inf</td></tr><tr><td style="text-align: right">including existing infrastructure (no extra costs)</td><td style="text-align: right">-</td><td style="text-align: right"><code>existing_infrastructure</code></td><td style="text-align: right">true or false</td><td style="text-align: right">::Bool</td><td style="text-align: right">false</td></tr><tr><td style="text-align: right">type of storage implementation</td><td style="text-align: right">-</td><td style="text-align: right"><code>storage</code></td><td style="text-align: right">&quot;none&quot;, &quot;simple&quot; or &quot;seasonal&quot;</td><td style="text-align: right">::String</td><td style="text-align: right">&quot;none&quot;</td></tr><tr><td style="text-align: right">allowing transmission</td><td style="text-align: right">-</td><td style="text-align: right"><code>transmission</code></td><td style="text-align: right">true or false</td><td style="text-align: right">::Bool</td><td style="text-align: right">false</td></tr><tr><td style="text-align: right">fix. var and CEO to dispatch problem</td><td style="text-align: right">-</td><td style="text-align: right"><code>fixed_design_variables</code></td><td style="text-align: right">design variables from design run or nothing</td><td style="text-align: right">::OptVariables</td><td style="text-align: right">nothing</td></tr><tr><td style="text-align: right">allowing lost load (necessary for dispatch)</td><td style="text-align: right">price/MWh</td><td style="text-align: right"><code>lost_el_load_cost</code></td><td style="text-align: right">&gt;1e6</td><td style="text-align: right">::Number</td><td style="text-align: right">Inf</td></tr><tr><td style="text-align: right">allowing lost emission (necessary for dispatch)</td><td style="text-align: right">price/kg-CO2e</td><td style="text-align: right"><code>lost_CO2_emission_cost</code></td><td style="text-align: right">&gt;700</td><td style="text-align: right">::Number</td><td style="text-align: right">Inf</td></tr></table><p>They can be applied in the following way:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CapacityExpansion.run_opt" href="#CapacityExpansion.run_opt"><code>CapacityExpansion.run_opt</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">run_opt(ts_data::ClustData,opt_data::OptDataCEP,opt_config::Dict{String,Any},optimizer::DataType)</code></pre><p>Organizing the actual setup and run of the CEP-Problem. This function shouldn&#39;t be called by a user, but from within the other <code>run_opt</code>-functions Required elements are:</p><ul><li><code>ts_data</code>: The time-series data.</li><li><code>opt_data</code>: In this case the OptDataCEP that contains information on costs, nodes, techs and for transmission also on lines.</li><li><code>opt_config</code>: This includes all the settings for the design optimization problem formulation.</li><li><code>optimizer</code>: The used optimizer, which could e.g. be Clp: <code>using Clp</code> <code>optimizer=Clp.Optimizer</code> or Gurobi: <code>using Gurobi</code> <code>optimizer=Gurobi.Optimizer</code>.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CapacityExpansion.jl/blob/27a8dae05d02cc661a492af4bc4e653b110db908/src/optim_problems/run_opt.jl#L1-L9">source</a><div><div><pre><code class="language-none"> run_opt(ts_data::ClustData,opt_data::OptDataCEP,opt_config::Dict{String,Any},fixed_design_variables::Dict{String,Any},optimizer::DataTyple;lost_el_load_cost::Number=Inf,lost_CO2_emission_cost::Number)</code></pre><p>This problem runs the operational optimization problem only, with fixed design variables. provide the fixed design variables and the <code>opt_config</code> of the previous step (design run or another opterational run) Required elements are:</p><ul><li><code>ts_data</code>: The time-series data, which should be be the original time-series data for this operational run. The <code>keys(ts_data.data)</code> need to match the <code>[time_series_name]-[node]</code></li><li><code>opt_data</code>: In this case the OptDataCEP that contains information on costs, nodes, techs and for transmission also on lines. - Should be the same as in the design run.</li><li><code>opt_config</code>: This includes all the previous settings for the design optimization problem formulation and ensures that the configuration is the same.</li><li><code>fixed_design_variables</code>: All the design variables that are determined by the previous design run.</li><li><code>optimizer</code>: The used optimizer, which could e.g. be Clp: <code>using Clp</code> <code>optimizer=Clp.Optimizer</code> or Gurobi: <code>using Gurobi</code> <code>optimizer=Gurobi.Optimizer</code>.</li></ul><p>What you can change in the <code>opt_config</code>:</p><ul><li><code>lost_el_load_cost</code>: Number indicating the lost load price/MWh (should be greater than 1e6), give a number lower than Inf for SLACK and LL (Lost Load - a variable for unmet demand by the installed capacities). No SLACK and LL can lead to infeasibilities.</li><li><code>lost_CO2_emission_cost</code>: Number indicating the emission price/kg-CO2 (should be greater than 1e6), give Inf for no LE (Lost Emissions - a variable for emissions that will exceed the limit in order to provide the demand with the installed capacities). No LE can lead to a higher SLACK and LL, as the optimization is not allowed to break any emission limit then.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CapacityExpansion.jl/blob/27a8dae05d02cc661a492af4bc4e653b110db908/src/optim_problems/run_opt.jl#L68-L81">source</a><div><div><pre><code class="language-none"> run_opt(ts_data::ClustData,opt_data::OptDataCEP,optimizer::DataTyple;co2_limit::Number=Inf,lost_el_load_cost::Number=Inf,lost_CO2_emission_cost::Number=Inf,existing_infrastructure::Bool=false,limit_infrastructure::Bool=false,storage::String=&quot;none&quot;,transmission::Bool=false,descriptor::String=&quot;&quot;,print_flag::Bool=true,optimizer_config::Dict{Symbol,Any}=Dict{Symbol,Any}(),round_sigdigits::Int=9)</code></pre><p>Wrapper function for type of optimization problem for the CEP-Problem (NOTE: identifier is the type of <code>opt_data</code> - in this case OptDataCEP - so identification as CEP problem). Required elements are:</p><ul><li><code>ts_data</code>: The time-series data, which could either be the original input data or some aggregated time-series data. The <code>keys(ts_data.data)</code> need to match the <code>[time_series_name]-[node]</code></li><li><code>opt_data</code>: The OptDataCEP that contains information on costs, nodes, techs and for transmission also on lines.</li><li><code>optimizer</code>: The used optimizer, which could e.g. be Clp: <code>using Clp</code> <code>optimizer=Clp.Optimizer</code> or Gurobi: <code>using Gurobi</code> <code>optimizer=Gurobi.Optimizer</code>.</li></ul><p>Options to tweak the model are:</p><ul><li><code>co2_limit</code>: A number limiting the kg.-CO2-eq./MWh (normally in a range from 5-1250 kg-CO2-eq/MWh), give Inf or no kw if unlimited</li><li><code>lost_el_load_cost</code>: Number indicating the lost load price/MWh (should be greater than 1e6), give Inf for no SLACK and LL (Lost Load - a variable for unmet demand by the installed capacities)</li><li><code>lost_CO2_emission_cost</code>: Number indicating the emission price/kg-CO2 (should be greater than 1e6), give Inf for no LE (Lost Emissions - a variable for emissions that will exceed the limit in order to provide the demand with the installed capacities)</li><li><code>existing_infrastructure</code>: true or false to include or exclude existing infrastructure to the model</li><li><code>storage</code>: String &quot;none&quot; for no storage or &quot;simple&quot; to include simple (only intra-day storage) or &quot;seasonal&quot; to include seasonal storage (inter-day)</li></ul><p>Optional elements are:</p><ul><li><code>descriptor</code>: String with the name of this paricular model like &quot;kmeans-10-co2-500&quot;</li><li><code>print_flag</code>: Bool to decide if a summary of the Optimization result should be printed.</li><li><code>optimizer_config</code>: Each Symbol and the corresponding value in the Dictionary is passed on to the <code>with_optimizer</code> function in addition to the <code>optimizer</code>. For Gurobi an example Dictionary could look like <code>Dict{Symbol,Any}(:Method =&gt; 2, :OutputFlag =&gt; 0, :Threads =&gt; 2)</code> more information can be found in the optimizer specific documentation.</li><li><code>round_sigdigits</code>: Can be used to round the values of the result to a certain number of <code>sigdigits</code>.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CapacityExpansion.jl/blob/27a8dae05d02cc661a492af4bc4e653b110db908/src/optim_problems/run_opt.jl#L99-L117">source</a></section><h2><a class="nav-anchor" id="Solver-1" href="#Solver-1">Solver</a></h2><p>The package provides no <code>optimizer</code> and a solver has to be added separately. For the linear optimization problem suggestions are:</p><ul><li><code>Clp</code> as an open source solver</li><li><code>Gurobi</code> as a proprietary solver with free academic licenses</li><li><code>CPLEX</code> as an alternative proprietary solver</li></ul><p>Install the corresponding julia-package for the solver and call its <code>optimizer</code> like e.g.:</p><pre><code class="language-julia">using Pkg
Pkg.add(&quot;Clp&quot;)
using Clp
optimizer=Clp.Optimizer</code></pre><h2><a class="nav-anchor" id="Opt-Result-A-closer-look-1" href="#Opt-Result-A-closer-look-1">Opt Result - A closer look</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CapacityExpansion.OptResult" href="#CapacityExpansion.OptResult"><code>CapacityExpansion.OptResult</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">  OptResult{status::Symbol,objective::Float64,variables::Dict{String,Any},sets::Dict{String,Array},opt_config::Dict{String,Any},opt_info::Dict{String,Any}}</code></pre><ul><li><code>status</code>: Symbol about the solution status of the model in normal cases <code>:OPTIMAL</code></li><li><code>objective</code>: Value of the objective function</li><li><code>variables</code>: Dictionary with each OptVariable as an entry</li><li><code>sets</code>: Dictionary with each set as an entry</li><li><code>opt_config</code>: The configuration of the model setup - for more detail see tye <code>run_opt</code> documentation that sets the <code>opt_config</code> up</li><li><code>opt_info</code>: Holds information about the model. E.g. <code>opt_info[&quot;model&quot;]</code> contains the exact equations used in the model.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CapacityExpansion.jl/blob/27a8dae05d02cc661a492af4bc4e653b110db908/src/utils/datastructs.jl#L31-L39">source</a></section><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The model tracks how it is setup and which equations are used. This can help you to understand the models exact configuration without looking up the source code.</p></div></div><p>The information of the model setup can be checked out the following way:</p><div></div><pre><code class="language-julia">result = run_opt(ts_clust_data,cep_data,optimizer;descriptor=&quot;Model Name&quot;)
println.(result.opt_info[&quot;model&quot;])</code></pre><pre><code class="language-none">10-element Array{Nothing,1}:
 nothing
 nothing
 nothing
 nothing
 nothing
 nothing
 nothing
 nothing
 nothing
 nothing</code></pre><footer><hr/><a class="previous" href="../README_TX_1/"><span class="direction">Previous</span><span class="title">TX-1</span></a><a class="next" href="../opt_cep_examples/"><span class="direction">Next</span><span class="title">Examples</span></a></footer></article></body></html>

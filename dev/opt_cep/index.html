<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimization · CEP.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="CEP.jl logo"/></a><h1>CEP.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Introduction</a></li><li><a class="toctext" href="../workflow/">Workflow</a></li><li><a class="toctext" href="../load_data/">Load Data</a></li><li class="current"><a class="toctext" href>Optimization</a><ul class="internal"><li><a class="toctext" href="#General-1">General</a></li><li><a class="toctext" href="#Variables-and-Sets-1">Variables and Sets</a></li><li><a class="toctext" href="#Data-1">Data</a></li><li><a class="toctext" href="#Opt-Types-1">Opt Types</a></li><li><a class="toctext" href="#Running-the-Capacity-Expansion-Problem-1">Running the Capacity Expansion Problem</a></li><li><a class="toctext" href="#Get-Functions-1">Get Functions</a></li></ul></li><li><a class="toctext" href="../opt_cep_data/">Provided Data</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Optimization</a></li></ul><a class="edit-page" href="https://github.com/YoungFaithful/CEP.jl/blob/master/docs/src/opt_cep.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Optimization</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Optimization-Capacity-Expansion-Problem-1" href="#Optimization-Capacity-Expansion-Problem-1">Optimization Capacity Expansion Problem</a></h1><h2><a class="nav-anchor" id="General-1" href="#General-1">General</a></h2><p>The capacity expansion problem (CEP) is designed as a linear optimization model. It is implemented in the algebraic modeling language <a href="http://www.juliaopt.org/JuMP.jl/latest/">JUMP</a>. The implementation within JuMP allows to optimize multiple models in parallel and handle the steps from data input to result analysis and diagram export in one open source programming language. The coding of the model enables scalability based on the provided data input, single command based configuration of the setup model, result and configuration collection for further analysis and the opportunity to run design and operation in different optimizations.</p><p><img src="../assets/opt_cep.svg" alt="Plot"/></p><p>The basic idea for the energy system is to have a spacial resolution of the energy system in discrete nodes. Each node has demand, non-dispatchable generation, dispatachable generation and storage capacities of varying technologies connected to itself. The different energy system nodes are interconnected with each other by transmission lines. The model is designed to minimize social costs by minimizing the following objective function:</p><div>\[min \sum_{account,tech}COST_{account,&#39;EUR/USD&#39;,tech} + \sum LL \cdot  cost_{LL} + LE \cdot  cos_{LE}\]</div><h2><a class="nav-anchor" id="Variables-and-Sets-1" href="#Variables-and-Sets-1">Variables and Sets</a></h2><p>The models scalability is relying on the usage of sets. The elements of the sets are extracted from the input data and scale the different variables. An overview of the sets is provided in the table. Depending on the models configuration the necessary sets are initialized.</p><table><tr><th>name</th><th>description</th></tr><tr><td>lines</td><td>transmission lines connecting the nodes</td></tr><tr><td>nodes</td><td>spacial energy system nodes</td></tr><tr><td>tech</td><td>fossil and renewable generation as well as storage technologies</td></tr><tr><td>impact</td><td>impact categories like EUR or USD, CO 2 − eq., ...</td></tr><tr><td>account</td><td>fixed costs for installation and yearly expenses, variable costs</td></tr><tr><td>infrastruct</td><td>infrastructure status being either new or existing</td></tr><tr><td>sector</td><td>energy sector like electricity</td></tr><tr><td>time K</td><td>numeration of the representative periods</td></tr><tr><td>time T</td><td>numeration of the time intervals within a period</td></tr><tr><td>time T e</td><td>numeration of the time steps within a period</td></tr><tr><td>time I</td><td>numeration of the time invervals of the full input data periods</td></tr><tr><td>time I e</td><td>numeration of the time steps of the full input data periods</td></tr><tr><td>dir transmission</td><td>direction of the flow uniform with or opposite to the lines direction</td></tr></table><p>An overview of the variables used in the CEP is provided in the table:</p><table><tr><th>name</th><th>dimensions</th><th>unit</th><th>description</th></tr><tr><td>COST</td><td>[account,impact,tech]</td><td>EUR/USD, LCA-categories</td><td>Costs</td></tr><tr><td>CAP</td><td>[tech,infrastruct,node]</td><td>MW</td><td>Capacity</td></tr><tr><td>GEN</td><td>[sector,tech,t,k,node]</td><td>MW</td><td>Generation</td></tr><tr><td>SLACK</td><td>[sector,t,k,node]</td><td>MW</td><td>Power gap, not provided by installed CAP</td></tr><tr><td>LL</td><td>[sector]</td><td>MWh</td><td>LoastLoad Generation gap, not provided by installed CAP</td></tr><tr><td>LE</td><td>[impact]</td><td>LCA-categories</td><td>LoastEmission Amount of emissions that installed CAP crosses the Emission constraint</td></tr><tr><td>INTRASTOR</td><td>[sector, tech,t,k,node]</td><td>MWh</td><td>Storage level within a period</td></tr><tr><td>INTERSTOR</td><td>[sector,tech,i,node]</td><td>MWh</td><td>Storage level between periods of the full time series</td></tr><tr><td>FLOW</td><td>[sector,dir,tech,t,k,line]</td><td>MW</td><td>Flow over transmission line</td></tr><tr><td>TRANS</td><td>[tech,infrastruct,lines]</td><td>MW</td><td>maximum capacity of transmission lines</td></tr></table><h2><a class="nav-anchor" id="Data-1" href="#Data-1">Data</a></h2><p>The package provides data <a href="@ref">Capacity Expansion Data</a> for:</p><table><tr><th>name</th><th>nodes</th><th>lines</th><th>years</th><th>tech</th></tr><tr><td>GER_1</td><td>1 – germany as single node</td><td>none</td><td>2006-2016</td><td>Pv, wind, coal, oil, gas, bat<em>e, bat</em>in, bat<em>out, h2</em>e, h2<em>in, h2</em>out, trans</td></tr><tr><td>GER_18</td><td>18 – dena-zones within germany</td><td>49</td><td>2015</td><td>Pv, wind, coal, oil, gas, bat<em>e, bat</em>in, bat<em>out, h2</em>e, h2<em>in, h2</em>out, trans</td></tr><tr><td>CA_1</td><td>1 - california as single node</td><td>none</td><td>2016</td><td>Pv, wind, coal, oil, gas, bat<em>e, bat</em>in, bat<em>out, h2</em>e, h2<em>in, h2</em>out, trans</td></tr><tr><td>CA_14 ! currently not included !</td><td>14 – multiple nodes within CA and neighboring states</td><td>46</td><td>2016</td><td>Pv, wind, coal, oil, gas, bat<em>e, bat</em>in, bat<em>out, h2</em>e, h2<em>in, h2</em>out, trans</td></tr><tr><td>TX_1</td><td>1 – single node within Texas</td><td>none</td><td>2008</td><td>Pv, wind, coal, nuc, gas, bat<em>e, bat</em>in, bat_out</td></tr></table><h2><a class="nav-anchor" id="Opt-Types-1" href="#Opt-Types-1">Opt Types</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CEP.OptDataCEP" href="#CEP.OptDataCEP"><code>CEP.OptDataCEP</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none"> OptDataCEP{region::String, costs::OptVariable, techs::OptVariable, nodes::OptVariable, lines::OptVariabl} &lt;: OptData</code></pre><p>-<code>region::String</code>          name of state or region data belongs to -<code>costs::OptVariable</code>    costs[tech,node,year,account,impact] - Number -<code>techs::OptVariable</code>    techs[tech] - OptDataCEPTech -<code>nodes::OptVariable</code>    nodes[tech, node] - OptDataCEPNode -<code>lines::OptVarible</code>     lines[tech, line] - OptDataCEPLine instead of USD you can also use your favorite currency like EUR</p></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/utils/datastructs.jl#L41-L49">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CEP.OptResult" href="#CEP.OptResult"><code>CEP.OptResult</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>OptResult</p></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/utils/datastructs.jl#L31">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CEP.OptVariable" href="#CEP.OptVariable"><code>CEP.OptVariable</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none"> OptVariable</code></pre><p>-<code>data::Array</code> - includes the optimization variable output in  form of an array -<code>axes_names::Array{String,1}</code><code>- includes the names of the different axes and is equivalent to the sets in the optimization formulation -</code>axes::Tuple<code>- includes the values of the different axes of the optimization variables -</code>type::String` - defines the type of the variable being cv - cost variable - dv -design variable - ov - operating variable - sv - slack variable</p></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/utils/datastructs.jl#L16-L22">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CEP.Scenario" href="#CEP.Scenario"><code>CEP.Scenario</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none"> Scenario{descriptor::String,clust_res::ClustResult,opt_res::OptResult}</code></pre><p>-<code>descriptor::String</code> -<code>clust_res::ClustResult</code> -<code>opt_res::OptResult</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/utils/datastructs.jl#L153-L158">source</a></section><h2><a class="nav-anchor" id="Running-the-Capacity-Expansion-Problem-1" href="#Running-the-Capacity-Expansion-Problem-1">Running the Capacity Expansion Problem</a></h2><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The CEP model can be run with many configurations. The configurations themselves don&#39;t mess with each other though the provided input data must fulfill the ability to have e.g. lines in order for transmission to work.</p></div></div><p>An overview is provided in the following table:</p><table><tr><th>description</th><th>unit</th><th>configuration</th><th>values</th><th>type</th><th>default value</th></tr><tr><td>enforce a CO2-limit</td><td>kg-CO2-eq./MW</td><td>co2_limit</td><td>&gt;0</td><td>::Number</td><td>Inf</td></tr><tr><td>including existing infrastructure (no extra costs)</td><td>-</td><td>existing_infrastructure</td><td>true or false</td><td>::Bool</td><td>false</td></tr><tr><td>type of storage implementation</td><td>-</td><td>storage</td><td>&quot;none&quot;, &quot;simple&quot; or &quot;seasonal&quot;</td><td>::String</td><td>&quot;none&quot;</td></tr><tr><td>allowing transmission</td><td>-</td><td>transmission</td><td>true or false</td><td>::Bool</td><td>FALSE</td></tr><tr><td>fixing design variables and turning capacity expansion problem into dispatch problem</td><td>-</td><td>fixed<em>design</em>variables</td><td>design variables from design run or nothing</td><td>::OptVariables</td><td>nothing</td></tr><tr><td>allowing lost load (just necessary if design variables fixed)</td><td>price/MWh</td><td>lost<em>el</em>load_cost</td><td>&gt;1e6</td><td>::Number</td><td>Inf</td></tr><tr><td>allowing lost emission (just necessary if design variables fixed)</td><td>price/kg_CO2-eq.</td><td>lost<em>CO2</em>emission_cost</td><td>&gt;700</td><td>::Number</td><td>Inf</td></tr></table><p>They can be applied in the following way:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CEP.run_opt" href="#CEP.run_opt"><code>CEP.run_opt</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">run_opt(ts_data::ClustData,opt_data::OptDataCEP,opt_config::Dict{String,Any};optimizer::DataType)</code></pre><p>organizing the actual setup and run of the CEP-Problem</p></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/optim_problems/run_opt.jl#L1-L4">source</a><div><div><pre><code class="language-none"> run_opt(ts_data::ClustData,opt_data::OptDataCEP,opt_config::Dict{String,Any},fixed_design_variables::Dict{String,Any},optimizer::DataTyple;lost_el_load_cost::Number=Inf,lost_CO2_emission_cost::Number)</code></pre><p>Wrapper function for type of optimization problem for the CEP-Problem (NOTE: identifier is the type of <code>opt_data</code> - in this case OptDataCEP - so identification as CEP problem) This problem runs the operational optimization problem only, with fixed design variables. provide the fixed design variables and the <code>opt_config</code> of the previous step (design run or another opterational run) what you can add to the opt_config:</p><ul><li><code>lost_el_load_cost</code>: Number indicating the lost load price/MWh (should be greater than 1e6),   give Inf for none</li><li><code>lost_CO2_emission_cost</code>: Number indicating the emission price/kg-CO2 (should be greater than 1e6), give Inf for none</li><li>give Inf for both lost_cost for no slack</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/optim_problems/run_opt.jl#L48-L57">source</a><div><div><pre><code class="language-none"> run_opt(ts_data::ClustData,opt_data::OptDataCEP,optimizer::DataTyple;descriptor::String=&quot;&quot;,co2_limit::Number=Inf,lost_el_load_cost::Number=Inf,lost_CO2_emission_cost::Number=Inf,existing_infrastructure::Bool=false,limit_infrastructure::Bool=false,storage::String=&quot;none&quot;,transmission::Bool=false,print_flag::Bool=true,print_level::Int64=0)</code></pre><p>Wrapper function for type of optimization problem for the CEP-Problem (NOTE: identifier is the type of <code>opt_data</code> - in this case OptDataCEP - so identification as CEP problem) options to tweak the model are:</p><ul><li><code>descritor</code>: String with the name of this paricular model like &quot;kmeans-10-co2-500&quot;</li><li><code>co2_limit</code>: A number limiting the kg.-CO2-eq./MWh (normally in a range from 5-1250 kg-CO2-eq/MWh), give Inf or no kw if unlimited</li><li><code>lost_el_load_cost</code>: Number indicating the lost load price/MWh (should be greater than 1e6),   give Inf for none</li><li><code>lost_CO2_emission_cost</code>:<ul><li>Number indicating the emission price/kg-CO2 (should be greater than 1e6), give Inf for none</li><li>give Inf for both lost_cost for no slack</li></ul></li><li><code>existing_infrastructure</code>: true or false to include or exclude existing infrastructure to the model</li><li><code>storage</code>: String &quot;none&quot; for no storage or &quot;simple&quot; to include simple (only intra-day storage) or &quot;seasonal&quot; to include seasonal storage (inter-day)</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/optim_problems/run_opt.jl#L75-L87">source</a></section><h3><a class="nav-anchor" id="Examples-1" href="#Examples-1">Examples</a></h3><h4><a class="nav-anchor" id="Example-with-CO2-Limitation-1" href="#Example-with-CO2-Limitation-1">Example with CO2-Limitation</a></h4><pre><code class="language-julia">using CEP
using Clp
optimizer=Clp.Optimizer #select an Optimize
state=&quot;GER_1&quot; #select state
ts_input_data = load_timeseries_data_provided(&quot;CEP&quot;, state; K=365, T=24)
cep_data = load_cep_data_provided(state)
ts_clust_data = run_clust(ts_input_data;method=&quot;kmeans&quot;,representation=&quot;centroid&quot;,n_init=5,n_clust=5).best_results
# tweak the CO2 level
co2_result = run_opt(ts_clust_data,cep_data,optimizer;descriptor=&quot;co2&quot;,co2_limit=500)
co2_result.status</code></pre><h4><a class="nav-anchor" id="Example-with-slack-variables-included-1" href="#Example-with-slack-variables-included-1">Example with slack variables included</a></h4><pre><code class="language-julia">slack_result = run_opt(ts_clust_data,cep_data,optimizer;descriptor=&quot;slack&quot;,lost_el_load_cost=1e6, lost_CO2_emission_cost=700)</code></pre><h4><a class="nav-anchor" id="Example-for-simple-storage-1" href="#Example-for-simple-storage-1">Example for simple storage</a></h4><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>In simple or intradaystorage the storage level is enforced to be the same at the beginning and end of each day. The variable &#39;INTRASTORAGE&#39; is tracking the storage level within each day of the representative periods.</p></div></div><pre><code class="language-julia">simplestor_result = run_opt(ts_clust_data,cep_data,optimizer;descriptor=&quot;simple storage&quot;,storage=&quot;simple&quot;)</code></pre><h4><a class="nav-anchor" id="Example-for-seasonal-storage-1" href="#Example-for-seasonal-storage-1">Example for seasonal storage</a></h4><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>In seasonalstorage the storage level is enforced to be the same at the beginning and end of the original time-series. The new variable &#39;INTERSTORAGE&#39; tracks the storage level throughout the days (or periods) of the original time-series. The variable &#39;INTRASTORAGE&#39; is tracking the storage level within each day of the representative periods.</p></div></div><pre><code class="language-julia">seasonalstor_result = run_opt(ts_clust_data,cep_data,optimizer;descriptor=&quot;seasonal storage&quot;,storage=&quot;seasonal&quot;,k_ids=run_clust(ts_input_data;method=&quot;kmeans&quot;,representation=&quot;centroid&quot;,n_init=5,n_clust=5).best_ids)</code></pre><h4><a class="nav-anchor" id="Example-for-second-stage-operational-validation-step-1" href="#Example-for-second-stage-operational-validation-step-1">Example for second stage operational validation step</a></h4><pre><code class="language-julia">design_result = run_opt(ts_clust_data,cep_data,optimizer;descriptor=&quot;design&amp;operation&quot;, co2_limit=50)
#the design variables (here the capacity_factors) are calculated from the first optimization
design_variables=get_cep_design_variables(design_result)
# Use the design variable results for the operational (dispatch problem) run
operation_result = run_opt(ts_input_data,cep_data,design_result.opt_config,design_variables,optimizer;lost_el_load_cost=1e6,lost_CO2_emission_cost=700)</code></pre><h2><a class="nav-anchor" id="Get-Functions-1" href="#Get-Functions-1">Get Functions</a></h2><p>The get functions allow an easy access to the information included in the result.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CEP.get_cep_variable_set" href="#CEP.get_cep_variable_set"><code>CEP.get_cep_variable_set</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">get_cep_variable_set(variable::OptVariable,num_index_set::Int)</code></pre><p>Get the variable set from the specific variable and the <code>num_index_set</code> like 1</p></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/utils/utils.jl#L100-L103">source</a><div><div><pre><code class="language-none">get_cep_variable_set(scenario::Scenario,var_name::String,num_index_set::Int)</code></pre><p>Get the variable set from the specific Scenario by indicating the <code>var_name</code> e.g. &quot;COST&quot; and the <code>num_index_set</code> like 1</p></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/utils/utils.jl#L111-L114">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CEP.get_cep_slack_variables" href="#CEP.get_cep_slack_variables"><code>CEP.get_cep_slack_variables</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">get_cep_slack_variables(opt_result::OptResult)</code></pre><p>Returns all slack variables in this <code>opt_result</code> mathing the type &quot;sv&quot;</p></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/utils/utils.jl#L133-L136">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CEP.get_cep_design_variables" href="#CEP.get_cep_design_variables"><code>CEP.get_cep_design_variables</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">get_cep_design_variables(opt_result::OptResult; capacity_factors::Dict{String,Number}=Dict{String,Number}())</code></pre><p>Returns all design variables in this opt_result matching the type &quot;dv&quot; Additionally you can add capacity factors, which scale the design variables by multiplying it with the value in the Dict</p></div></div><a class="source-link" target="_blank" href="https://github.com/YoungFaithful/CEP.jl/blob/743522a2e21d344a7f4d5b40617c28bde9dda1c0/src/utils/utils.jl#L123-L127">source</a></section><h4><a class="nav-anchor" id="Example-plotting-Capacities-1" href="#Example-plotting-Capacities-1">Example plotting Capacities</a></h4><pre><code class="language-julia">co2_result = run_opt(ts_clust_data,cep_data,optimizer;descriptor=&quot;co2&quot;,co2_limit=500) #hide
using Plots
# use the get variable set in order to get the labels: indicate the variable as &quot;CAP&quot; and the set-number as 1 to receive those set values
variable=co2_result.variables[&quot;CAP&quot;]
labels=get_cep_variable_set(variable,1)
# use the get variable value function to recieve the values of CAP[:,:,1]
data=get_cep_variable_value(variable,[:,:,1])
# use the data provided for a simple bar-plot without a legend
bar(data,title=&quot;Cap&quot;, xticks=(1:length(labels),labels),legend=false)</code></pre><footer><hr/><a class="previous" href="../load_data/"><span class="direction">Previous</span><span class="title">Load Data</span></a><a class="next" href="../opt_cep_data/"><span class="direction">Next</span><span class="title">Provided Data</span></a></footer></article></body></html>
